<project name="JSmol" default="toJs" basedir=".">
 
   <!-- you must have checked out and built the Jmol project prior to running this. -->
	
	
   <property name="jmol.path" value="../Jmol" />
	<property name="jsv.path" value="../JSpecView" />

   <target name="toJs" id="toJs">
  			
  	<!-- create a NON svn local directory only containing JS files  -->
  	
  	<echo>Deleting the site directory.</echo>
   	 	<delete quiet="true" dir="site" />

   	<echo>creating site/jsmol/j2s</echo>

   	<copy todir="site/jsmol/j2s/java" >
      <fileset dir="j2s/java">
        <include name="**/*.js" />
      </fileset>
    </copy>

    <copy overwrite="true" todir="site/jsmol/j2s/java" >
      <fileset dir="bin/java">
        <include name="**/*.js" />
      </fileset>
    </copy>

    <copy todir="site/jsmol/j2s/JZ" >
      <fileset dir="bin/com/jcraft/jzlib">
        <include name="**/*.js" />
      </fileset>
    </copy>
    
   	<copy todir="site/jsmol/j2s/J" >
      <fileset dir="bin/org/jmol">
        <include name="**/*.js" />
      </fileset>
    </copy>
   	
   	<copy todir="site/jsmol/j2s/JSV" >
      <fileset dir="bin/jspecview">
        <include name="**/*.js" />
      </fileset>
    </copy>
   	
   	<copy todir="site/jsmol/j2s/JU" >
      <fileset dir="bin/javajs/util">
        <include name="**/*.js" />
      </fileset>
    </copy>
   	
   	<copy todir="site/jsmol/j2s/javajs" >
      <fileset dir="bin/javajs">
        <include name="**/*.js" />
        <exclude name="**/util	/*.js" />
      </fileset>
    </copy>

   	
  	<!-- modify class names -->		

    <echo>modifying class names "org.jmol" to "J"</echo>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="org.jmol" value="J"/>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="org/jmol" value="J"/>

    <echo>modifying class names "javajs.util" to "JU"</echo>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="javajs.util" value="JU"/>

  	<echo>modifying class names "com.jcraft.jzlib" to "JZ"</echo>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="com.jcraft.jzlib" value="JZ"/>
   	
  	<echo>modifying class names "jspecview" to "JSV"</echo>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="jspecview" value="JSV"/>
    <echo>modifying class names "Clazz.defineMethod " to "$_M"</echo>
  	<replace dir="site/jsmol/j2s" includes="**/*.js" token="Clazz.defineMethod " value="$_M"/>
   	  	
  	<!-- get version information  -->		
    <copy todir="site/jsmol/j2s" >
  	  <fileset dir="">
  	    <include name="Jmol.properties" />
  	  </fileset>
    </copy>
   	
   	<copy todir="site/jsmol/j2s/J" >
  	  <fileset dir="">
  	    <include name="Jmol.properties" />
  	  </fileset>
    </copy>
   	
  	<!-- get required non-JavaScript resources -->		
    <copy todir="site/jsmol/j2s/J/minimize/forcefield/data" >
      <fileset dir="${jmol.path}/src/org/jmol/minimize/forcefield/data">
        <include name="*.txt" />
      </fileset>
    </copy>
    <copy todir="site/jsmol/j2s/J/modelkit/images">
      <fileset dir="${jmol.path}/src/org/jmol/modelkit/images">
        <include name="*" />
      </fileset>
    </copy>
   	   	
    <copy todir="site/jsmol/j2s/JSV/common" >
      <fileset dir="${jsv.path}">
        <include name="TODO.txt" />
      </fileset>
		  <filterchain>
		    <striplinecomments>
		      <comment value="#" />
		    </striplinecomments>
		    <linecontains>
		      <contains value="___" />
		    </linecontains>
		  </filterchain>
    </copy>
   	<echo>adding version information to JSVersion.js</echo>
   	<concat destfile="temp.js"><filelist dir="site/jsmol/j2s/JSV/common" files="
   		TODO.txt
   		JSVersion.js
   		" />
   	</concat>
  	<move file="temp.js" tofile="site/jsmol/j2s/JSV/common/JSVersion.js" />

  	<!-- get .po files from the Jmol project -->		
   	<copy overwrite="true" todir="site/jsmol/j2s/trans" >
	  <fileset dir="${jmol.path}/src/org/jmol/translation/JmolApplet">
	    <include name="*.po" />
	  </fileset>
	</copy>


   	<!-- add jspecview files and subdirectories -->

   		<copy todir="site/jsmol/j2s/JSV/export/resources" >
      <fileset dir="${jsv.path}/src/jspecview/export/resources">
        <include name="*.vm" />
      </fileset>
    </copy>

   	<!-- add jsmol files and subdirectories -->

   	<copy todir="site/jsmol">
  	  <fileset dir="html">
  	    <include name="**/*" />
  	  </fileset>
      <fileset dir="">
    	 <include name="README.TXT" />
      </fileset>
    </copy>

   	<copy todir="site/jsmol/data">
  	  <fileset dir="data">
  	    <include name="**/*" />
  	  </fileset>
    </copy> 
   	
   	<copy todir="site/jsmol/flot">
  	  <fileset dir="lib/flot">
  	    <include name="**/*" />
  	  </fileset>
    </copy>
 	
  	<copy todir="site/jsmol/java">
  	  <fileset dir="${jmol.path}/build">
  	    <include name="JmolApplet*.jar" />
  	  </fileset>
	  <fileset dir="${jmol.path}/appletweb">
	    <include name="JSpecViewApplet*.jar" />
	  </fileset>
	</copy>

   	<copy todir="site/jsmol/jme">
  	  <fileset dir="lib/jme">
  	    <include name="**/*" />
  	  </fileset>
    </copy>

  	<copy todir="site/jsmol/jquery">
  	  <fileset dir="lib/jquery">
  	    <include name="**/*" />
  	  </fileset>
    </copy>

   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/jquery" failonerror="false">
   		<arg line="--js jquery.js --js_output_file jquery.min.js" />
    </java>

  	<copy todir="site/jsmol/jsme">
  	  <fileset dir="lib/jsme">
  	    <include name="**/*" />
  	  </fileset>
    </copy>
	   	
   	<copy todir="site/jsmol/js">
  	  <fileset dir="jsmoljs">
  	    <include name="**/*" />
  	  </fileset>
    </copy> 
   	
  	<copy todir="site/jsmol/php">
  	  <fileset dir="php">
  	    <include name="**/*" />
  	  </fileset>
    </copy>
  
  	<copy todir="site/jsmol/j2s/img">
  	  <fileset dir="img">
  	    <include name="**/*" />
  	  </fileset>
    </copy>
   	
   	<!-- make core files -->
 
   	<copy todir="site/jsmol/j2s/core">
  	  <fileset dir="${jmol.path}/srcjs/js">
  	    <include name="package.js" />
  	  </fileset>
    </copy>


   	<!-- note: any changes in these next sections must be reflected also
   	             in package.js -->
   	
   	<concat destfile="site/jsmol/js/corescript.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/JmolScriptManager.js
   		J/api/JmolScriptEvaluator.js
   		J/api/JmolScriptFunction.js
   		J/script/FileLoadThread.js
   		J/script/ScriptQueueThread.js
   		J/script/ScriptDelayThread.js
   		J/script/CommandWatcherThread.js
   		J/script/ScriptManager.js
   		J/script/ScriptEvaluator.js
   		J/script/ScriptCompiler.js
   		J/script/ScriptCompilationTokenParser.js
   		J/script/ScriptFlowContext.js
   		J/script/ScriptFunction.js
   		J/script/ScriptInterruption.js
   		J/script/ScriptMathProcessor.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corescript.js --js_output_file ../j2s/core/corescript.z.js" />
    </java>

   	<concat destfile="site/jsmol/js/corescript2.js"><filelist dir="site/jsmol/j2s" files="
   		J/script/JmolScriptExtension.js
   		J/scriptext/ScriptExt.js
   		" />
   	</concat> 	   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corescript2.js --js_output_file ../j2s/core/corescript2.z.js" />
    </java>

   	<concat destfile="site/jsmol/js/corestate.js"><filelist dir="site/jsmol/j2s" files="
   		J/viewer/JmolStateCreator.js
   		J/viewer/StateCreator.js
   		" />
   	</concat> 	   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corestate.js --js_output_file ../j2s/core/corestate.z.js" />
    </java>

   	<concat destfile="site/jsmol/js/coreprop.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/JmolPropertyManager.js
   		J/viewer/PropertyManager.js   	   	
   	   	" />
    </concat>	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coreprop.js --js_output_file ../j2s/core/coreprop.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/coreconsole.js"><filelist dir="site/jsmol/j2s" files="
   		../../../jsmoljs/core/coreconsoletop.js
   		J/api/JmolAppConsoleInterface.js
   		J/console/GenericTextArea.js
   		J/console/GenericConsole.js
   		J/consolejs/AppletConsole.js   	   	  	   	
   	   	" />
   	</concat>   	   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coreconsole.js --js_output_file ../j2s/core/coreconsole.z.js" />
    </java>
  	<concat destfile="site/jsmol/js/coremenu.js"><filelist dir="site/jsmol/j2s" files="
   		../../../jsmoljs/core/coremenutop.js
   		J/api/JmolPopupInterface.js
   		J/popup/JmolAbstractMenu.js
   		J/popup/GenericPopup.js
   		J/awtjs2d/JSPopup.js
   		J/awtjs2d/JSmolPopup.js
   		J/popup/PopupResource.js
   		J/popup/MainPopupResourceBundle.js
   		" />
   	</concat> 		
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coremenu.js --js_output_file ../j2s/core/coremenu.z.js" />
    </java>
	<concat destfile="site/jsmol/js/coremin.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/MinimizerInterface.js
   		J/minimize/Minimizer.js
   		J/minimize/MinObject.js
   		J/minimize/MinAngle.js
   		J/minimize/MinAtom.js
   		J/minimize/MinBond.js
   		J/minimize/MinTorsion.js
   		J/minimize/Util.js
   		J/minimize/forcefield/AtomType.js
   		J/minimize/forcefield/ForceField.js
   		J/minimize/forcefield/ForceFieldMMFF.js
   		J/minimize/forcefield/ForceFieldUFF.js
   		J/minimize/forcefield/Calculation.js
   		J/minimize/forcefield/Calculations.js
   		J/minimize/forcefield/CalculationsMMFF.js
   		J/minimize/forcefield/CalculationsUFF.js
   		J/minimize/forcefield/FFParam.js
   		J/minimize/MinimizationThread.js
    	" />
   	</concat>   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coremin.js --js_output_file ../j2s/core/coremin.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/corezip.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/JmolZipUtility.js
   		J/io2/ZipUtil.js
   		java/io/FileInputStream.js
   		JZ/Checksum.js
   		JZ/CRC32.js
   		java/util/zip/CRC32.js
   		JZ/InflaterInputStream.js
   		java/util/zip/InflaterInputStream.js
   		java/util/zip/GZIPInputStream.js
   		JZ/ZStream.js
   		JZ/Inflater.js
   		JZ/Adler32.js
   		JZ/Tree.js
   		JZ/StaticTree.js
   		JZ/GZIPHeader.js
   		JZ/Inflate.js
   		JZ/InfTree.js
   		JZ/InfBlocks.js
   		JZ/InfCodes.js
   		java/util/zip/CheckedInputStream.js
   		java/util/zip/Inflater.js
   		java/util/zip/ZipException.js
   		java/util/zip/ZipConstants.js
   		java/util/zip/ZipEntry.js
   		java/util/zip/ZipConstants64.js
   		java/util/zip/ZipInputStream.js
   		java/io/PushbackInputStream.js
   		J/api/ZInputStream.js
   		J/io2/JmolZipInputStream.js
   	   	" />
   	</concat>   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corezip.js --js_output_file ../j2s/core/corezip.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/corebio.js"><filelist dir="site/jsmol/j2s" files="
   		J/adapter/readers/pdb/PdbReader.js
   		J/adapter/smarter/Structure.js
   		J/api/JmolBioResolver.js
   		J/modelsetbio/Resolver.js
   		J/modelsetbio/Monomer.js
   		J/modelsetbio/AlphaMonomer.js
   		J/modelsetbio/ProteinStructure.js
   		J/modelsetbio/Helix.js
   		J/modelsetbio/Sheet.js
   		J/modelsetbio/Turn.js
   		J/modelsetbio/BioPolymer.js
   		J/modelsetbio/AlphaPolymer.js
   		J/modelsetbio/AminoMonomer.js
   		J/modelsetbio/AminoPolymer.js
   		J/modelsetbio/BioModel.js
   		J/modelsetbio/CarbohydrateMonomer.js
   		J/modelsetbio/CarbohydratePolymer.js
   		J/modelsetbio/PhosphorusMonomer.js
   		J/modelsetbio/NucleicMonomer.js
   		J/modelsetbio/NucleicPolymer.js
   		J/modelsetbio/PhosphorusPolymer.js
   		J/dssx/Bridge.js
   		J/dssx/DSSP.js
   		J/shapebio/BioShape.js
   		J/shapebio/BioShapeCollection.js
   		J/shapebio/Rockets.js
   		J/shapebio/Cartoon.js
   		J/shapebio/Backbone.js
   		J/shapebio/Strands.js
   		J/shapebio/Ribbons.js
   		J/shapebio/MeshRibbon.js
   		J/shapebio/Trace.js
   		J/renderbio/BioShapeRenderer.js
   		J/renderbio/StrandsRenderer.js
   		J/renderbio/RibbonsRenderer.js
   		J/renderbio/MeshRibbonRenderer.js
   		J/renderbio/RocketsRenderer.js
   		J/renderbio/CartoonRenderer.js
   		J/renderbio/BackboneRenderer.js
   		J/renderbio/TraceRenderer.js
   	   	" />
   	</concat>   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corebio.js --js_output_file ../j2s/core/corebio.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/coresurface.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/VolumeDataInterface.js
   		J/jvxl/api/VertexDataServer.js
   		J/jvxl/api/MeshDataServer.js
   		J/shapesurface/Isosurface.js
   		J/jvxl/data/JvxlCoder.js
   		J/jvxl/data/VolumeData.js
   		J/jvxl/data/JvxlData.js
   		J/jvxl/data/MeshData.js
   		J/jvxl/readers/XmlReader.js
   		J/jvxl/readers/SurfaceGenerator.js
   		J/jvxl/readers/Parameters.js
   		J/jvxl/readers/SurfaceReader.js
   		J/jvxl/calc/MarchingCubes.js
   		J/jvxl/calc/MarchingSquares.js
   		J/shapesurface/IsosurfaceMesh.js
   		J/jvxl/readers/VolumeDataReader.js
   		J/jvxl/readers/AtomDataReader.js
   		J/jvxl/readers/IsoSolventReader.js
   		J/jvxl/readers/SurfaceFileReader.js
   		J/jvxl/readers/VolumeFileReader.js
   		J/jvxl/readers/JvxlXmlReader.js
   		J/rendersurface/IsosurfaceRenderer.js
   	   	" />
   	</concat>	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coresurface.js --js_output_file ../j2s/core/coresurface.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/coresym.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/SymmetryInterface.js
   		J/symmetry/Symmetry.js
   		J/symmetry/PointGroup.js
   		J/symmetry/SpaceGroup.js
   		J/symmetry/HallInfo.js
   		J/symmetry/HallRotationTerm.js
   		J/symmetry/HallRotation.js
   		J/symmetry/HallTranslation.js
   		J/symmetry/SymmetryOperation.js
   		J/symmetry/SymmetryInfo.js
   		J/symmetry/UnitCell.js
   	" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coresym.js --js_output_file ../j2s/core/coresym.z.js" />
    </java>
   	<concat destfile="site/jsmol/js/corebinary.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/JmolDocument.js
   		java/io/PushbackInputStream.js
   		java/io/DataInputStream.js
   		JU/ByteConverter.js
   		J/io2/BinaryDocument.js
   	   	" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corebinary.js --js_output_file ../j2s/core/corebinary.z.js" />
    </java>
   	
   	
   	<concat destfile="site/jsmol/js/corepymol.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/JmolSceneGenerator.js
   		J/adapter/readers/pymol/PickleReader.js
   		J/api/PymolAtomReader.js
   		J/adapter/readers/pymol/PyMOL.js
   		J/adapter/readers/pymol/JmolObject.js
   		J/adapter/readers/pymol/PyMOLGroup.js
   		J/adapter/readers/pymol/PyMOLScene.js
   		J/adapter/readers/pymol/PyMOLReader.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js corepymol.js --js_output_file ../j2s/core/corepymol.z.js" />
    </java>

   	
   	<concat destfile="site/jsmol/js/coretext.js"><filelist dir="site/jsmol/j2s" files="
   		J/modelset/Object2d.js
   		J/modelset/Text.js
   		J/shape/Object2dShape.js
   		J/shape/TextShape.js
   		J/shape/Labels.js
   		J/shape/Echo.js
   		J/shape/Hover.js
   		J/render/TextRenderer.js
   		J/render/LabelsRenderer.js
   		J/render/EchoRenderer.js
   		J/render/HoverRenderer.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coretext.js --js_output_file ../j2s/core/coretext.z.js" />
    </java>

   	
   	
   	<concat destfile="site/jsmol/js/coresmiles.js"><filelist dir="site/jsmol/j2s" files="
   		J/api/SmilesMatcherInterface.js
   		J/smiles/SmilesMatcher.js
   		J/smiles/InvalidSmilesException.js
   		J/smiles/SmilesSearch.js
   		J/smiles/SmilesGenerator.js
   		J/smiles/SmilesAromatic.js
   		J/smiles/SmilesAtom.js
   		J/smiles/SmilesBond.js
   		J/smiles/SmilesMeasure.js
   		J/smiles/SmilesParser.js
   		" />
   	</concat>   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js coresmiles.js --js_output_file ../j2s/core/coresmiles.z.js" />
    </java>
	<concat destfile="site/jsmol/js/core.js"><filelist dir="site/jsmol/j2s" files="
   		../../../Jmol.properties
   		../../../jsmoljs/core/coretop.js
   		JU/T3.js
   		JU/T3i.js
   		JU/T3d.js
   		JU/P3.js
   		JU/P3i.js
   		JU/V3.js
   		JU/V3d.js
   		JU/M3.js
   		JU/T4.js
   		JU/P4.js
   		JU/M4.js
   		JU/A4.js
   		JU/BS.js
   		JU/SB.js
		JU/DecimalFormat.js
   		JU/Parser.js
   		JU/ArrayUtil.js
   		java/util/MapEntry.js
   		java/util/Dictionary.js
   		java/util/AbstractCollection.js
   		java/lang/AbstractStringBuilder.js
   		java/lang/StringBuilder.js
   		java/lang/StringBuffer.js
   		java/util/AbstractList.js
   		java/util/ArrayList.js
   		JU/List.js
   		JU/ColorUtil.js
   		javajs/api/FontManager.js
   		javajs/awt/Font.js
   		java/net/Parts.js
   		java/util/AbstractSet.js
   		java/util/Arrays.js
   		java/util/AbstractMap.js
   		java/util/SortedMap.js
   		java/util/SortedSet.js
   		java/util/Collections.js
   		java/util/Hashtable.js
   		javajs/awt/Dimension.js
   		java/io/InputStream.js
   		java/io/ByteArrayInputStream.js
   		java/io/FilterInputStream.js
   		java/io/BufferedInputStream.js
   		java/io/Reader.js
   		java/io/InputStreamReader.js
   		java/io/BufferedReader.js
   		java/io/StringReader.js
   		java/io/OutputStream.js
		java/io/ByteArrayOutputStream.js
   		java/net/MalformedURLException.js
   		java/net/URLEncoder.js
   		java/net/URLDecoder.js
   		java/net/URLStreamHandlerFactory.js
   		java/net/URLStreamHandler.js
   		java/net/URL.js
   		java/net/URLConnection.js
   		JU/AjaxURLConnection.js
   		JU/AjaxURLStreamHandlerFactory.js
   		JU/AjaxURLStreamHandler.js
   		java/text/MessageFormat.js
   		java/util/Random.js
   		J/util/LoggerInterface.js
   		J/util/DefaultLogger.js
   		J/util/Logger.js
   		J/i18n/Resource.js
   		J/i18n/Language.js
   		J/i18n/GT.js
   		J/api/JmolCallbackListener.js
   		J/api/JmolStatusListener.js
   		J/api/JmolSyncInterface.js
   		J/appletjs/Jmol.js
   		J/appletjs/JmolAppletRegistry.js
   		java/lang/Enum.js
   		J/constant/EnumCallback.js
   		J/util/Escape.js
   		J/util/ParserBS.js
   		J/util/Txt.js
   		J/script/T.js
   		J/util/BSUtil.js
   		J/util/JmolEdge.js
   		J/modelset/Bond.js
   		J/util/Measure.js
   		J/script/SV.js
   		J/io/Encoding.js
   		java/util/Properties.js
   		J/util/Elements.js
   		J/util/Vibration.js
   		J/viewer/JC.js
   		J/util/Int2IntHash.js
   		J/util/C.js
   		J/util/Quaternion.js
   		J/constant/EnumPalette.js
   		J/util/Shader.js
   		J/api/JmolViewer.js
   		J/atomdata/AtomDataServer.js
   		J/constant/EnumVdw.js
   		J/atomdata/RadiusData.js
   		J/util/CommandHistory.js
		J/api/JSmolInterface.js
   		J/viewer/Viewer.js
   		java/lang/Thread.js
   		J/constant/EnumQuantumShell.js
   		J/api/JmolAdapter.js
   		J/adapter/smarter/SmarterJmolAdapter.js
   		J/api/Interface.js
   		java/lang/ThreadGroup.js
   		J/constant/EnumAxesMode.js
   		J/constant/EnumFileStatus.js
   		J/api/JmolAdapterAtomIterator.js
   		J/adapter/smarter/AtomIterator.js
   		J/adapter/smarter/AtomSetCollection.js
   		J/api/JmolAdapterBondIterator.js
   		J/adapter/smarter/BondIterator.js
   		J/adapter/smarter/Resolver.js
   		J/api/JmolAdapterStructureIterator.js
   		J/adapter/smarter/StructureIterator.js
   		J/modelset/Group.js
   		J/adapter/smarter/Atom.js
   		J/adapter/smarter/AtomSetObject.js
   		J/adapter/smarter/Bond.js
   		J/constant/EnumStructure.js
   		java/util/StringTokenizer.js
   		J/adapter/smarter/AtomSetCollectionReader.js
   		J/thread/JmolThread.js
   		J/io/LimitedLineReader.js
   		J/constant/EnumStereoMode.js
   		J/io/Base64.js
   		J/io/CifDataReader.js
   		J/io/JmolBinary.js
  		J/shape/Shape.js
		J/api/BytePoster.js
   		J/viewer/FileManager.js
   		J/script/ContextToken.js
   		J/script/ScriptContext.js
   		J/constant/EnumAnimationMode.js
   		J/io/FileReader.js
   		J/viewer/DataManager.js
   		J/util/JmolNode.js
   		J/util/Point3fi.js
   		J/modelset/Atom.js
   		J/modelset/AtomCollection.js
   		J/modelset/LabelToken.js
   		J/api/JmolMeasurementClient.js
   		J/modelset/MeasurementData.js
   		J/util/BoxInfo.js
   		J/modelset/BondCollection.js
   		J/modelset/ModelCollection.js
   		J/atomdata/AtomData.js
   		J/modelset/Measurement.js
   		J/util/Geodesic.js
   		J/util/Normix.js
   		J/modelset/BondIterator.js
   		J/modelset/BondIteratorSelected.js
   		J/modelset/HBond.js
 		J/bspt/Bspf.js
   		J/io/XmlUtil.js
   		J/api/AtomIndexIterator.js
   		J/modelset/AtomIteratorWithinModel.js
   		J/modelset/AtomIteratorWithinModelSet.js
   		J/bspt/Bspt.js
   		J/util/JmolMolecule.js
   		J/modelset/TickInfo.js
   		J/script/ScriptException.js
   		J/bspt/CubeIterator.js
   		J/bspt/Element.js
   		J/bspt/Leaf.js
   		J/util/ColorEncoder.js
   		J/api/JmolGraphicsInterface.js
   		J/util/GData.js
   		J/bspt/Node.js
   		J/util/MeshSurface.js
   		J/util/Rectangle.js
   		J/viewer/MouseState.js
		J/api/EventManager.js
   		J/viewer/ActionManager.js
   		J/viewer/StateManager.js
   		J/modelset/MeasurementPending.js
   		J/thread/HoverWatcherThread.js
   		J/viewer/binding/Binding.js
   		J/viewer/binding/DragBinding.js
   		J/viewer/binding/JmolBinding.js
   		J/thread/TimeoutThread.js
   		J/util/TempArray.js
   		J/viewer/AnimationManager.js
   		J/viewer/ColorManager.js
   		J/viewer/ShapeManager.js
   		J/viewer/ModelManager.js
   		J/viewer/SelectionManager.js
   		J/viewer/StatusManager.js
   		J/viewer/TransformManager.js
   		J/modelset/ModelLoader.js
   		J/viewer/TransformManager11.js
   		J/modelset/Chain.js
   		J/modelset/Model.js
   		J/modelset/ModelSet.js
   		J/api/PlatformViewer.js
   		J/api/ApiPlatform.js
   		J/awtjs2d/Platform.js
   		J/awtjs2d/Display.js
   		J/awtjs2d/JSFont.js
   		J/awtjs2d/Image.js
   		J/api/JmolFileInterface.js
   		J/awtjs2d/JSFile.js
   		J/api/JmolMouseInterface.js
   		J/api/Event.js
   		J/awtjs2d/Mouse.js
   		J/api/JmolRendererInterface.js
   		J/g3d/Graphics3D.js
   		J/g3d/SphereRenderer.js
   		J/g3d/CylinderRenderer.js
   		J/g3d/ImageRenderer.js
   		J/g3d/LineRenderer.js
   		J/g3d/Pixelator.js
   		J/g3d/PixelatorShaded.js
   		J/g3d/Platform3D.js
   		J/g3d/TextRenderer.js
   		J/g3d/TextSorter.js
   		J/g3d/TextString.js
   		J/util/Rgb16.js
		J/g3d/G3DRenderer.js
   		J/g3d/TriangleRenderer.js
   		J/api/JmolRepaintManager.js
   		J/render/RepaintManager.js
   		J/shape/AtomShape.js
   		J/shape/Balls.js
   		J/shape/Sticks.js
   		J/shape/FontShape.js
   		J/shape/FontLineShape.js
   		J/shape/Frank.js
   		J/render/ShapeRenderer.js
   		J/render/BallsRenderer.js
   		J/render/FontLineShapeRenderer.js
   		J/render/SticksRenderer.js
   		J/util/SimpleUnitCell.js
   		J/render/FrankRenderer.js
   		J/adapter/readers/molxyz/MolReader.js
   		J/adapter/readers/molxyz/XyzReader.js
   		J/awtjs/Platform.js
   		J/awtjs/JSFont.js
   		J/awtjs/Image.js
   		../../../jsmoljs/core/corebottom.js
   	   	" />
   	</concat>   	
   	<java jar="jars/closure_compiler.jar" fork="true" dir="site/jsmol/js" failonerror="false">
   		<arg line="--js core.js --js_output_file ../j2s/core/core.z.js" />
    </java>
   	
   	
   	<!-- minimize JSmol JavaScript -->
   	
   	<echo>JSmol.min.js is the standard set, including jQuery</echo>
   	<concat destfile="site/jsmol/js/JSmol.full.js"><filelist dir="jsmoljs" files="
   		../lib/jquery/jquery.js
   		JSmoljQueryExt.js
   		JSmolCore.js
   		JSmol.js
   		JSmolApplet.js
   		JSmolControls.js
   		JSmolApi.js
   		j2sjmol.js
   		" />
   	</concat>
   
   	<java jar="jars/closure_compiler.jar" fork="true" dir="" failonerror="false">
   		<arg line="--js site/jsmol/js/JSmol.full.js --js_output_file site/jsmol/JSmol.min.js" />
    </java>

   	<echo>JSmol.min.nojq.js is the standard set but does not include jQuery</echo>
  	<concat destfile="site/jsmol/js/jsmol.nojq.js"><filelist dir="jsmoljs" files="
   		JSmoljQueryExt.js
   		JSmolCore.js
   		JSmol.js
   		JSmolApplet.js
   		JSmolControls.js
   		JSmolApi.js
   		j2sjmol.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="" failonerror="false">
   		<arg line="--js site/jsmol/js/jsmol.nojq.js --js_output_file site/jsmol/JSmol.min.nojq.js" />
    </java>

   	<echo>JSmol.min.core.js includes JSmol.min.js and core.z.js</echo>
   	<concat destfile="site/jsmol/JSmol.min.core.js"><filelist dir="site/jsmol" files="
   		JSmol.min.js
   		../../jsmoljs/core/coretop2.js
   		j2s/core/core.z.js 
   		" />
   	</concat>

   	<echo>JSmol.lite.js is a very minimal non-Jmol viewer; includes jQuery</echo>
  	<concat destfile="temp.js"><filelist dir="jsmoljs" files="
   		../lib/jquery/jquery.js
   		JSmoljQueryExt.js
  		JSmolCore.js
  		JSmolTM.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="" failonerror="false">
   		<arg line="--js temp.js --js_output_file site/jsmol/JSmol.lite.js" />
    </java>

   	<echo>JSmol.lite.nojq.js is a very minimal non-Jmol viewer, without jQuery</echo>
  	<concat destfile="temp.js"><filelist dir="jsmoljs" files="
   		JSmoljQueryExt.js
  		JSmolCore.js
  		JSmolTM.js
   		" />
   	</concat>
   	<java jar="jars/closure_compiler.jar" fork="true" dir="" failonerror="false">
   		<arg line="--js temp.js --js_output_file site/jsmol/JSmol.lite.nojq.js" />
    </java>
   	

   	<echo>cleaning up files</echo>
 	<delete file="temp.js" />
   	<echo>creating distribution zip file jsmol.zip</echo>
  	<delete file="dist/*" />
    <zip zipfile="dist/jsmol.zip" basedir="site" includes="**" />
   	<copy overwrite="true" todir="${jmol.path}/appletweb" >
	  <fileset dir="dist">
	    <include name="jsmol.zip" />
	  </fileset>
	</copy>
   	<echo>dist/jsmol.zip and ${jmol.path}/appletweb/jsmol.zip have been updated. 
   		Now unzip dist/jsmol.zip into a local directory for testing</echo>
   	<echo>or run tools/jsmol-release.xml to release ${jmol.path}</echo>
   	<echo>If incorporating into a ${jmol.path} build, now run ${jmol.path}/build or run tools/jsmol-release.xml to release ${jmol.path}</echo>
  </target>

</project>
